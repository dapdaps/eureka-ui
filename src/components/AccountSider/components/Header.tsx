import { motion } from 'framer-motion';
import { memo } from 'react';
import styled from 'styled-components';

import useAccount from '@/hooks/useAccount';
import useConnectWallet from '@/hooks/useConnectWallet';
import { useLayoutStore } from '@/stores/layout';

import AccountItem from './AccountItem';
import SubtractItem from './SubtractItem';

const StyledHeader = styled.div`
  width: 100%;
  padding-left: var(--padding-x);
  padding-right: var(--padding-x);
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-shrink: 0;
`;

export const StyledDisconnectButton = styled(motion.div)`
  position: absolute;
  top: 0;
  right: 0;
  cursor: pointer;
  /* position: relative; */
  margin-left: 14px;
  .tips {
    display: none;
    position: absolute;
    left: 13px;
    top: 8px;
    color: #FF3EA6;
    font-family: Montserrat;
    font-size: 14px;
    font-style: normal;
    font-weight: 400;
    line-height: normal;
  }
  .leave-button {
    display: block;
  }
  .hover-button {
    display: none;
  }
  &:hover {
    .tips {
      display: block;
    }
    .leave-button {
      display: none;
    }
    .hover-button {
      display: block;
    }
  }
`;

const StyledCloseWidget = styled.div`
  position: relative;
  display: flex;
  padding-right: 42px;
`;

const Header = ({
  showInviteLink,
  setShowInviteLink,
}: {
  showInviteLink: boolean;
  setShowInviteLink: (show: boolean) => void;
}) => {
  const { account } = useAccount();
  const { onConnect, onDisconnect } = useConnectWallet();
  const setLayoutStore = useLayoutStore((store) => store.set);

  return (
    <StyledHeader>
      <AccountItem />
      <StyledCloseWidget>
        <SubtractItem showInviteLink={showInviteLink} setShowInviteLink={setShowInviteLink} />
        <StyledDisconnectButton
          whileHover={{ backgroundColor: 'rgba(55, 58, 83, 0.8)', borderRadius: 8, }}
          whileTap={{ backgroundColor: 'rgba(55, 58, 83, 0.6)', borderRadius: 8, }}
          onClick={async () => {
            if (account) {
              await onDisconnect();
              setLayoutStore({ showAccountSider: false });
            } else {
              onConnect();
            }
          }}
        >
          <div className="tips">Disconnect</div>
          <div className='leave-button'>
            <svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" viewBox="0 0 34 34" fill="none">
              <rect x="1" y="1" width="32" height="32" rx="8" fill="#373A53" fillOpacity="0.5" stroke="#373A53" />
              <path
                d="M13.4265 12.0986C13.0576 11.73 12.5043 11.73 12.1354 12.0986C11.7666 12.4672 11.7666 13.0202 12.1354 13.3888L21.2651 22.5119C21.4496 22.6962 21.6801 22.7883 21.9107 22.7883C22.1412 22.7883 22.3718 22.6962 22.5562 22.5119C22.9251 22.1433 22.9251 21.5904 22.5562 21.2217L13.4265 12.0986ZM17.1614 21.406L16.3314 22.2354C16.0086 22.558 15.6859 22.7883 15.2709 22.9266C14.487 23.2491 13.611 23.2491 12.8271 22.9266C12.4121 22.7423 12.0893 22.5119 11.7666 22.2354C11.4438 21.9129 11.2133 21.5904 11.0749 21.1757C10.9366 20.8071 10.8444 20.3924 10.8444 19.9777C10.8444 19.563 10.9366 19.1483 11.0749 18.7797C11.2594 18.365 11.4899 18.0425 11.7666 17.7199L12.5965 16.8906C12.9654 16.522 12.9654 15.969 12.5965 15.6004C12.2277 15.2318 11.6744 15.2318 11.3055 15.6004L10.4755 16.4298C10.0144 16.8906 9.59942 17.4896 9.36888 18.0886C9.13833 18.6875 9 19.3326 9 19.9777C9 20.6228 9.13833 21.2678 9.36888 21.8668C9.64553 22.5119 10.0144 23.0648 10.4755 23.5256C10.9366 23.9863 11.536 24.401 12.1354 24.6314C12.7349 24.8618 13.3804 25 14.0259 25C14.6715 25 15.317 24.8618 15.9164 24.6314C16.562 24.3549 17.1153 23.9863 17.5764 23.5256L18.4063 22.6962C18.7752 22.3276 18.7752 21.7747 18.4063 21.406C18.0836 21.0374 17.5303 21.0374 17.1614 21.406ZM24.6311 12.1447C24.3545 11.4996 23.9856 10.9467 23.5245 10.486C23.0634 10.0252 22.464 9.61051 21.8646 9.38013C20.6657 8.87329 19.2824 8.87329 18.0375 9.38013C17.3919 9.65659 16.8386 10.0252 16.3775 10.486L15.5476 11.3153C15.1787 11.6839 15.1787 12.2369 15.5476 12.6055C15.9164 12.9741 16.4697 12.9741 16.8386 12.6055L17.6686 11.7761C17.9914 11.4536 18.3141 11.2232 18.7291 11.085C19.513 10.7624 20.389 10.7624 21.1729 11.085C21.5879 11.2693 21.9107 11.4996 22.2334 11.7761C22.5562 12.0986 22.7867 12.4212 22.9251 12.8359C23.0634 13.2045 23.1556 13.6192 23.1556 14.0338C23.1556 14.4485 23.0634 14.8632 22.9251 15.2318C22.7406 15.6465 22.5101 15.969 22.2334 16.2916L21.4035 17.121C21.0346 17.4896 21.0346 18.0425 21.4035 18.4111C21.5879 18.5954 21.8184 18.6875 22.049 18.6875C22.2795 18.6875 22.5101 18.5954 22.6945 18.4111L23.5245 17.5817C23.9856 17.121 24.4006 16.522 24.6311 15.923C24.8617 15.324 25 14.6789 25 14.0338C25 13.3888 24.8617 12.7437 24.6311 12.1447Z"
                fill="#979ABE"
              />
            </svg>
          </div>
          <div className='hover-button'>
            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="34" viewBox="0 0 128 34" fill="none">
              <rect x="1" y="1" width="126" height="32" rx="8" fill="#373A53" stroke="#373A53" />
              <path d="M108.427 12.0986C108.058 11.73 107.504 11.73 107.135 12.0986C106.767 12.4672 106.767 13.0202 107.135 13.3888L116.265 22.5119C116.45 22.6962 116.68 22.7883 116.911 22.7883C117.141 22.7883 117.372 22.6962 117.556 22.5119C117.925 22.1433 117.925 21.5904 117.556 21.2217L108.427 12.0986ZM112.161 21.406L111.331 22.2354C111.009 22.558 110.686 22.7883 110.271 22.9266C109.487 23.2491 108.611 23.2491 107.827 22.9266C107.412 22.7423 107.089 22.5119 106.767 22.2354C106.444 21.9129 106.213 21.5904 106.075 21.1757C105.937 20.8071 105.844 20.3924 105.844 19.9777C105.844 19.563 105.937 19.1483 106.075 18.7797C106.259 18.365 106.49 18.0425 106.767 17.7199L107.597 16.8906C107.965 16.522 107.965 15.969 107.597 15.6004C107.228 15.2318 106.674 15.2318 106.305 15.6004L105.476 16.4298C105.014 16.8906 104.599 17.4896 104.369 18.0886C104.138 18.6875 104 19.3326 104 19.9777C104 20.6228 104.138 21.2678 104.369 21.8668C104.646 22.5119 105.014 23.0648 105.476 23.5256C105.937 23.9863 106.536 24.401 107.135 24.6314C107.735 24.8618 108.38 25 109.026 25C109.671 25 110.317 24.8618 110.916 24.6314C111.562 24.3549 112.115 23.9863 112.576 23.5256L113.406 22.6962C113.775 22.3276 113.775 21.7747 113.406 21.406C113.084 21.0374 112.53 21.0374 112.161 21.406ZM119.631 12.1447C119.354 11.4996 118.986 10.9467 118.524 10.486C118.063 10.0252 117.464 9.61051 116.865 9.38013C115.666 8.87329 114.282 8.87329 113.037 9.38013C112.392 9.65659 111.839 10.0252 111.378 10.486L110.548 11.3153C110.179 11.6839 110.179 12.2369 110.548 12.6055C110.916 12.9741 111.47 12.9741 111.839 12.6055L112.669 11.7761C112.991 11.4536 113.314 11.2232 113.729 11.085C114.513 10.7624 115.389 10.7624 116.173 11.085C116.588 11.2693 116.911 11.4996 117.233 11.7761C117.556 12.0986 117.787 12.4212 117.925 12.8359C118.063 13.2045 118.156 13.6192 118.156 14.0338C118.156 14.4485 118.063 14.8632 117.925 15.2318C117.741 15.6465 117.51 15.969 117.233 16.2916L116.403 17.121C116.035 17.4896 116.035 18.0425 116.403 18.4111C116.588 18.5954 116.818 18.6875 117.049 18.6875C117.28 18.6875 117.51 18.5954 117.695 18.4111L118.524 17.5817C118.986 17.121 119.401 16.522 119.631 15.923C119.862 15.324 120 14.6789 120 14.0338C120 13.3888 119.862 12.7437 119.631 12.1447Z" fill="#FF3EA6" />
            </svg>
          </div>
        </StyledDisconnectButton>
      </StyledCloseWidget>
    </StyledHeader>
  );
};

export default memo(Header);
